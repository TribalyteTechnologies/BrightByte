<ion-header no-border class="main-header">
    <ion-row no-padding class="header-row">
        <ion-col no-padding align-self-center>
            <div class="text-main">{{ "review.title" | translate }}</div>
        </ion-col>
    </ion-row>
</ion-header>

<ion-content padding class="main-container">
    <filter-selection [projects]="projects" [parentFilterValue]="filterValue" [parentPendingFilter]="filterIsPending" (filterEmit)="setFilter($event)" (projectEmit)="setProject($event)"></filter-selection>

    <ion-row no-padding>
        <ion-col padding class="text-details text-details--bold">
            {{ "commitReview.showAllCommits" | translate }}
        </ion-col>
        <ion-col col-6 padding class="text-details text-details--bold" *ngIf="currentCommit">
            {{ "commitReview.details" | translate }}
        </ion-col>
    </ion-row>
    <ion-row no-padding class="scroll-dimensions">
        <ion-col no-padding class="main-style scroll-y">
            <div class="scrollable-content">
                <div [ngClass]="commit === currentCommit ? 'card card__selected' : 'card'" *ngFor="let commit of filterArrayCommits; let i = index" (click)="shouldOpen(commit)">
                    <review-card [commit]="commit"></review-card>
                </div>
            </div>
        </ion-col>
        <ion-col col-6 *ngIf="currentCommit" class="scroll-y">
            <div class="scrollable-content">


                <ion-row padding class="main-style">
                    <ion-col>
                        <ion-row class="text-title"> {{ currentCommit.title }} </ion-row>
                        <ion-row align-items-center class="text-description">
                            <img class="ico " src="../../../../assets/imgs/project-icon.svg">{{ currentCommit.project }}
                            <img class="ico ico__margin" src="../../../../assets/imgs/user-icon.svg"> {{ currentCommitName }} ( {{ currentCommitEmail }} )
                        </ion-row>
                        <ion-row>
                            <div class="text-url text-ellipsis" (click)="openUrl(currentCommit.url, false)">  #{{ currentCommit.urlHash }}</div>
                        </ion-row>
                    </ion-col>
                </ion-row>
                <ion-row *ngIf="needReview" padding class="title-left text-details text-details--bold">
                    {{ "commitReview.setReview" | translate }}
                </ion-row>
                <ion-row padding class="main-style" *ngIf="needReview">
                    <ion-col>
                        <ion-row class="text-title">Set your review</ion-row>
                        <ion-row>
                            <ion-textarea placeholder="{{ 'commitReview.description' | translate }}" [(ngModel)]="textComment"></ion-textarea>
                        </ion-row>
                        <ion-row *ngFor="let critName of ['cleanCode', 'difficulty', 'reviewerExperience']; let i = index">
                            <ion-col>
                                    <ion-row class="padding-top-set-review padding-bottom-set-review">
                                            <div class="text-details">{{ "review."+critName | translate }}: </div>
                                    </ion-row>
                            </ion-col>
                            <ion-col>
                                <ion-row padding justify-content-left>
                                    <button class="star-style" *ngFor="let number of [0,1,2,3,4]" (click)="setReputation(number, i)">
                                        <ion-icon clas="icon-size" name="{{ stars[i][number] }}"></ion-icon>
                                    </button>
                                </ion-row>
                            </ion-col>
                        </ion-row>
                        <ion-row *ngIf="submitError != ''">
                            <div class="error-body">
                                {{ submitError }}
                            </div>
                        </ion-row>
                        <ion-row>
                            <button class="btn btn--full btn__blue" (click)="validateReview(currentCommit.url, textComment, rate);">
                            {{ "commitReview.review" | translate }}
                            </button>
                        </ion-row>
                    </ion-col>
                </ion-row>
                <ion-row padding *ngIf="userCommitComment[0]" class="text-details text-details--bold">
                    Your review
                </ion-row>
                <review-comment [review]="userCommitComment[0]" *ngIf="userCommitComment[0]"></review-comment>
                <ion-row padding *ngIf="!needReview" class="text-details text-details--bold">
                    {{ "review.otherReview" | translate }}
                </ion-row>
                <ion-col no padding *ngIf="!needReview">
                    <review-comment *ngFor="let comment of commitComments; let j=index " [review]="comment" (thumbsUp)="setThumbs(currentCommit.url,j, 1)" (thumbsDown)="setThumbs(currentCommit.url,j, 2)"></review-comment>
                    <ion-row padding></ion-row>
                </ion-col>
            </div>
        </ion-col>
    </ion-row>
</ion-content>